'use strict';var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a},_createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var path=require('path'),CopyPkgJsonPlugin=function(){function a(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;_classCallCheck(this,a),('object'!==('undefined'==typeof b?'undefined':_typeof(b))||Array.isArray(b))&&(b={}),this.options=b,this.context=c,this.pkgJsonRegExp=/\/?package.json$/}return _createClass(a,[{key:'apply',value:function apply(a){var b,c=this.options,d=this.context,e=d?d.match(this.pkgJsonRegExp)?path.resolve(d.replace(this.pkgJsonRegExp,''),'package.json'):path.resolve(d,'package.json'):path.resolve(process.cwd(),'package.json');try{a.inputFileSystem._statSync(e),b=JSON.parse(JSON.stringify(require(e)))}catch(a){throw new Error(this.notFoundError(e))}a.plugin('emit',function(a,d){if(c.hasOwnProperty('remove')&&c.remove.forEach(function(a){if(/\./.test(a)){var c,d=a.split('.'),e=d.length-1;d.forEach(function(a,d){0===d?c=b[a]:d===e?delete c[a]:c=c[a]})}else delete b[a]}),c.hasOwnProperty('replace'))for(var e in c.replace)if('object'===_typeof(c.replace[e])&&b.hasOwnProperty(e))for(var f in c.replace[e])b[e][f]=c.replace[e][f];else b[e]=c.replace[e];a.assets['package.json']={source:function source(){return JSON.stringify(b,null,'\t')},size:function size(){return Object.keys(b).length}},d()})}},{key:'notFoundError',value:function notFoundError(a){var b='\x1B[36m\x1B[1m',c='\x1B[0m';return'  '+'\x1B[41m\x1B[37m\x1B[1m'+'Cannot find the following package.json path:'+c+' '+'\x1B[33m'+a+c+'\n  If your package.json is not in the root directory of the current node process\n  pass the path to where it is located as the second argument to the plugin:\n    ie. '+b+'CopyPkgJsonPlugin'+c+'({options}, '+b+'\'path/main\''+c+')'}}]),a}();module.exports=CopyPkgJsonPlugin;